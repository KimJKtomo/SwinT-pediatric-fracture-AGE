/home/kimgk3793/anaconda3/envs/swin/bin/python /mnt/data/KimJG/SwinT/mediaiOA_swinT_cls-main_original/20250623_Single/run_all_training_0704.py 
✅ Step 1: age_test.csv already exists. Skipping test split.

📌 Step 2: Generating random train/val split...
📌 Step 2: Generating random train/val split...
📂 Loading full dataset and fixed test set...
🔍 Train/Val 대상 샘플 수: 19050
✅ Saved: age_train_tmp.csv, age_val_tmp.csv

📌 Step 3: Training Age Group Classifier...
🗂️ Train samples: 15390
🧪 Validation samples: 3848
/home/kimgk3793/anaconda3/envs/swin/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
[Epoch 0]: 100%|██████████| 1924/1924 [17:37<00:00,  1.82it/s]

📊 Val Confusion Matrix:
[[  19   20    0    0    0]
 [   2  175   19    0    0]
 [   0   56  945  201    0]
 [   0    0  161 1601  149]
 [   0    0    0  101  399]]
              precision    recall  f1-score   support

           0     0.9048    0.4872    0.6333        39
           1     0.6972    0.8929    0.7830       196
           2     0.8400    0.7862    0.8122      1202
           3     0.8413    0.8378    0.8395      1911
           4     0.7281    0.7980    0.7615       500

    accuracy                         0.8157      3848
   macro avg     0.8023    0.7604    0.7659      3848
weighted avg     0.8195    0.8157    0.8159      3848

✅ Best model saved.
[Epoch 1]: 100%|██████████| 1924/1924 [17:39<00:00,  1.82it/s]

📊 Val Confusion Matrix:
[[  32    7    0    0    0]
 [  12  142   42    0    0]
 [   0   19 1037  146    0]
 [   0    0  188 1645   78]
 [   0    0    0  142  358]]
              precision    recall  f1-score   support

           0     0.7273    0.8205    0.7711        39
           1     0.8452    0.7245    0.7802       196
           2     0.8185    0.8627    0.8400      1202
           3     0.8510    0.8608    0.8559      1911
           4     0.8211    0.7160    0.7650       500

    accuracy                         0.8352      3848
   macro avg     0.8126    0.7969    0.8024      3848
weighted avg     0.8354    0.8352    0.8344      3848

[Epoch 2]:   0%|          | 0/1924 [00:00<?, ?it/s]✅ Best model saved.
[Epoch 2]: 100%|██████████| 1924/1924 [17:41<00:00,  1.81it/s]

📊 Val Confusion Matrix:
[[  34    5    0    0    0]
 [   8  170   18    0    0]
 [   1   46 1006  149    0]
 [   0    0  199 1648   64]
 [   0    0    0  149  351]]
              precision    recall  f1-score   support

           0     0.7907    0.8718    0.8293        39
           1     0.7692    0.8673    0.8153       196
           2     0.8226    0.8369    0.8297      1202
           3     0.8469    0.8624    0.8546      1911
           4     0.8458    0.7020    0.7672       500

    accuracy                         0.8339      3848
   macro avg     0.8150    0.8281    0.8192      3848
weighted avg     0.8346    0.8339    0.8332      3848

✅ Best model saved.
[Epoch 3]: 100%|██████████| 1924/1924 [17:39<00:00,  1.82it/s]

📊 Val Confusion Matrix:
[[  35    4    0    0    0]
 [  12  160   24    0    0]
 [   1   36 1046  119    0]
 [   0    0  239 1489  183]
 [   0    0    0   66  434]]
              precision    recall  f1-score   support

           0     0.7292    0.8974    0.8046        39
           1     0.8000    0.8163    0.8081       196
           2     0.7991    0.8702    0.8331      1202
           3     0.8895    0.7792    0.8307      1911
           4     0.7034    0.8680    0.7771       500

    accuracy                         0.8222      3848
   macro avg     0.7842    0.8462    0.8107      3848
weighted avg     0.8309    0.8222    0.8231      3848

[Epoch 4]: 100%|██████████| 1924/1924 [17:36<00:00,  1.82it/s]

📊 Val Confusion Matrix:
[[  25   14    0    0    0]
 [   1  170   25    0    0]
 [   0   34 1052  116    0]
 [   0    0  287 1570   54]
 [   0    0    0  186  314]]
              precision    recall  f1-score   support

           0     0.9615    0.6410    0.7692        39
           1     0.7798    0.8673    0.8213       196
           2     0.7713    0.8752    0.8200      1202
           3     0.8387    0.8216    0.8300      1911
           4     0.8533    0.6280    0.7235       500

    accuracy                         0.8137      3848
   macro avg     0.8409    0.7666    0.7928      3848
weighted avg     0.8178    0.8137    0.8120      3848

[Epoch 5]: 100%|██████████| 1924/1924 [17:38<00:00,  1.82it/s]

📊 Val Confusion Matrix:
[[  24   15    0    0    0]
 [   4  134   58    0    0]
 [   0   10 1028  164    0]
 [   0    0  193 1654   64]
 [   0    0    0  175  325]]
              precision    recall  f1-score   support

           0     0.8571    0.6154    0.7164        39
           1     0.8428    0.6837    0.7549       196
           2     0.8038    0.8552    0.8287      1202
           3     0.8299    0.8655    0.8473      1911
           4     0.8355    0.6500    0.7312       500

    accuracy                         0.8225      3848
   macro avg     0.8338    0.7340    0.7757      3848
weighted avg     0.8234    0.8225    0.8204      3848

[Epoch 6]: 100%|██████████| 1924/1924 [17:39<00:00,  1.82it/s]

📊 Val Confusion Matrix:
[[  25   14    0    0    0]
 [   5  158   33    0    0]
 [   0   26 1017  159    0]
 [   0    0  211 1631   69]
 [   0    0    0  157  343]]
              precision    recall  f1-score   support

           0     0.8333    0.6410    0.7246        39
           1     0.7980    0.8061    0.8020       196
           2     0.8065    0.8461    0.8258      1202
           3     0.8377    0.8535    0.8455      1911
           4     0.8325    0.6860    0.7522       500

    accuracy                         0.8248      3848
   macro avg     0.8216    0.7665    0.7900      3848
weighted avg     0.8252    0.8248    0.8238      3848

[Epoch 7]: 100%|██████████| 1924/1924 [17:39<00:00,  1.82it/s]

📊 Val Confusion Matrix:
[[  31    8    0    0    0]
 [   5  167   24    0    0]
 [   0   36  974  192    0]
 [   0    0  158 1617  136]
 [   0    0    0   99  401]]
              precision    recall  f1-score   support

           0     0.8611    0.7949    0.8267        39
           1     0.7915    0.8520    0.8206       196
           2     0.8426    0.8103    0.8261      1202
           3     0.8475    0.8462    0.8468      1911
           4     0.7467    0.8020    0.7734       500

    accuracy                         0.8290      3848
   macro avg     0.8179    0.8211    0.8187      3848
weighted avg     0.8301    0.8290    0.8293      3848

[Epoch 8]: 100%|██████████| 1924/1924 [17:35<00:00,  1.82it/s]

📊 Val Confusion Matrix:
[[  29   10    0    0    0]
 [   3  161   32    0    0]
 [   0   30 1022  148    2]
 [   0    0  207 1359  345]
 [   0    0    0   39  461]]
              precision    recall  f1-score   support

           0     0.9062    0.7436    0.8169        39
           1     0.8010    0.8214    0.8111       196
           2     0.8105    0.8502    0.8299      1202
           3     0.8790    0.7111    0.7862      1911
           4     0.5705    0.9220    0.7049       500

    accuracy                         0.7879      3848
   macro avg     0.7935    0.8097    0.7898      3848
weighted avg     0.8138    0.7879    0.7909      3848

[Epoch 9]: 100%|██████████| 1924/1924 [17:36<00:00,  1.82it/s]

📊 Val Confusion Matrix:
[[  29   10    0    0    0]
 [   6  168   22    0    0]
 [   0   41  945  216    0]
 [   0    0  118 1664  129]
 [   0    0    0   92  408]]
              precision    recall  f1-score   support

           0     0.8286    0.7436    0.7838        39
           1     0.7671    0.8571    0.8096       196
           2     0.8710    0.7862    0.8264      1202
           3     0.8438    0.8707    0.8571      1911
           4     0.7598    0.8160    0.7869       500

    accuracy                         0.8352      3848
   macro avg     0.8141    0.8147    0.8128      3848
weighted avg     0.8373    0.8352    0.8352      3848

[Epoch 10]: 100%|██████████| 1924/1924 [17:37<00:00,  1.82it/s]

📊 Val Confusion Matrix:
[[  33    6    0    0    0]
 [   6  169   21    0    0]
 [   1   41 1032  128    0]
 [   0    0  293 1498  120]
 [   0    0    0  117  383]]
              precision    recall  f1-score   support

           0     0.8250    0.8462    0.8354        39
           1     0.7824    0.8622    0.8204       196
           2     0.7667    0.8586    0.8100      1202
           3     0.8594    0.7839    0.8199      1911
           4     0.7614    0.7660    0.7637       500

    accuracy                         0.8095      3848
   macro avg     0.7990    0.8234    0.8099      3848
weighted avg     0.8135    0.8095    0.8097      3848

[Epoch 11]: 100%|██████████| 1924/1924 [17:37<00:00,  1.82it/s]

📊 Val Confusion Matrix:
[[  35    4    0    0    0]
 [   8  157   31    0    0]
 [   0   31  980  190    1]
 [   0    0  154 1490  267]
 [   0    0    0   48  452]]
              precision    recall  f1-score   support

           0     0.8140    0.8974    0.8537        39
           1     0.8177    0.8010    0.8093       196
           2     0.8412    0.8153    0.8281      1202
           3     0.8623    0.7797    0.8189      1911
           4     0.6278    0.9040    0.7410       500

    accuracy                         0.8093      3848
   macro avg     0.7926    0.8395    0.8102      3848
weighted avg     0.8225    0.8093    0.8115      3848

[Epoch 12]: 100%|██████████| 1924/1924 [17:34<00:00,  1.82it/s]

📊 Val Confusion Matrix:
[[  28   11    0    0    0]
 [   5  152   39    0    0]
 [   0   27 1012  163    0]
 [   0    0  174 1615  122]
 [   0    0    0  108  392]]
              precision    recall  f1-score   support

           0     0.8485    0.7179    0.7778        39
           1     0.8000    0.7755    0.7876       196
           2     0.8261    0.8419    0.8340      1202
           3     0.8563    0.8451    0.8507      1911
           4     0.7626    0.7840    0.7732       500

    accuracy                         0.8313      3848
   macro avg     0.8187    0.7929    0.8046      3848
weighted avg     0.8318    0.8313    0.8314      3848

⏹️ Early stopping.

🎉 Age Group Classifier training completed.

📌 Step 4: Training Fracture Classifiers by Age Group...

🔹 Training for Age Group 0...
/home/kimgk3793/anaconda3/envs/swin/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]

🔁 Epoch 0
[Train] Loss: 1.6619 | Acc: 0.4923 | F1: 0.0000
[[32  0]
 [33  0]]
[Train] Sigmoid Range: min=0.1972, max=0.1972, mean=0.1972
[Val] Acc: 0.0833 | F1: 0.0000
[[ 1  0]
 [11  0]]
[Val] Sigmoid Range: min=0.1875, max=0.2541, mean=0.2239

🔁 Epoch 1
[Train] Loss: 1.2318 | Acc: 0.5692 | F1: 0.0000
[[37  0]
 [28  0]]
[Train] Sigmoid Range: min=0.0869, max=0.0869, mean=0.0869
[Val] Acc: 0.0833 | F1: 0.0000
[[ 1  0]
 [11  0]]
[Val] Sigmoid Range: min=0.0947, max=0.1876, mean=0.1385

🔁 Epoch 2
[Train] Loss: 1.3892 | Acc: 0.4308 | F1: 0.0000
[[28  0]
 [37  0]]
[Train] Sigmoid Range: min=0.0537, max=0.0537, mean=0.0537
[Val] Acc: 0.0833 | F1: 0.0000
[[ 1  0]
 [11  0]]
[Val] Sigmoid Range: min=0.0898, max=0.2489, mean=0.1710

🔁 Epoch 3
[Train] Loss: 1.5506 | Acc: 0.4462 | F1: 0.0000
[[29  0]
 [36  0]]
[Train] Sigmoid Range: min=0.2419, max=0.2419, mean=0.2419
[Val] Acc: 0.0833 | F1: 0.0000
[[ 1  0]
 [11  0]]
[Val] Sigmoid Range: min=0.1514, max=0.4136, mean=0.2865

🔁 Epoch 4
[Train] Loss: 1.4400 | Acc: 0.5538 | F1: 0.2564
[[31  0]
 [29  5]]
[Train] Sigmoid Range: min=0.2619, max=0.2619, mean=0.2619
[Val] Acc: 0.4167 | F1: 0.5333
[[1 0]
 [7 4]]
[Val] Sigmoid Range: min=0.2421, max=0.5595, mean=0.3946

🔁 Epoch 5
[Train] Loss: 1.0996 | Acc: 0.7077 | F1: 0.4865
[[37  0]
 [19  9]]
[Train] Sigmoid Range: min=0.1413, max=0.1413, mean=0.1413
[Val] Acc: 0.0833 | F1: 0.0000
[[ 1  0]
 [11  0]]
[Val] Sigmoid Range: min=0.0903, max=0.4374, mean=0.2731

🔁 Epoch 6
[Train] Loss: 1.0619 | Acc: 0.6000 | F1: 0.3500
[[32  0]
 [26  7]]
[Train] Sigmoid Range: min=0.5680, max=0.5680, mean=0.5680
[Val] Acc: 0.0833 | F1: 0.0000
[[ 1  0]
 [11  0]]
[Val] Sigmoid Range: min=0.0554, max=0.4187, mean=0.2353

🔁 Epoch 7
[Train] Loss: 1.0512 | Acc: 0.5231 | F1: 0.1622
[[31  0]
 [31  3]]
[Train] Sigmoid Range: min=0.1149, max=0.1149, mean=0.1149
[Val] Acc: 0.5000 | F1: 0.6250
[[1 0]
 [6 5]]
[Val] Sigmoid Range: min=0.0747, max=0.5926, mean=0.3495

🔁 Epoch 8
[Train] Loss: 0.7722 | Acc: 0.8000 | F1: 0.7547
[[32  0]
 [13 20]]
[Train] Sigmoid Range: min=0.5507, max=0.5507, mean=0.5507
[Val] Acc: 0.5833 | F1: 0.7059
[[1 0]
 [5 6]]
[Val] Sigmoid Range: min=0.1197, max=0.7134, mean=0.4559

🔁 Epoch 9
[Train] Loss: 0.7168 | Acc: 0.8923 | F1: 0.8955
[[28  0]
 [ 7 30]]
[Train] Sigmoid Range: min=0.7301, max=0.7301, mean=0.7301
[Val] Acc: 0.7500 | F1: 0.8421
[[1 0]
 [3 8]]
[Val] Sigmoid Range: min=0.1591, max=0.7987, mean=0.5478

🔁 Epoch 10
[Train] Loss: 0.5110 | Acc: 0.9692 | F1: 0.9697
[[31  0]
 [ 2 32]]
[Train] Sigmoid Range: min=0.9459, max=0.9459, mean=0.9459
[Val] Acc: 0.7500 | F1: 0.8421
[[1 0]
 [3 8]]
[Val] Sigmoid Range: min=0.0834, max=0.8181, mean=0.5348

🔁 Epoch 11
[Train] Loss: 0.6298 | Acc: 0.8615 | F1: 0.8364
[[33  0]
 [ 9 23]]
[Train] Sigmoid Range: min=0.1570, max=0.1570, mean=0.1570
[Val] Acc: 0.7500 | F1: 0.8421
[[1 0]
 [3 8]]
[Val] Sigmoid Range: min=0.0525, max=0.8389, mean=0.5207

🔁 Epoch 12
[Train] Loss: 1.0240 | Acc: 0.8923 | F1: 0.8727
[[34  0]
 [ 7 24]]
[Train] Sigmoid Range: min=0.0900, max=0.0900, mean=0.0900
[Val] Acc: 0.7500 | F1: 0.8421
[[1 0]
 [3 8]]
[Val] Sigmoid Range: min=0.0689, max=0.8768, mean=0.5663

🔁 Epoch 13
[Train] Loss: 0.2783 | Acc: 0.9538 | F1: 0.9589
[[27  0]
 [ 3 35]]
[Train] Sigmoid Range: min=0.8965, max=0.8965, mean=0.8965
[Val] Acc: 0.9167 | F1: 0.9565
[[ 0  1]
 [ 0 11]]
[Val] Sigmoid Range: min=0.5906, max=0.9355, mean=0.8089

🔁 Epoch 14
[Train] Loss: 0.5773 | Acc: 0.9538 | F1: 0.9647
[[21  3]
 [ 0 41]]
[Train] Sigmoid Range: min=0.1240, max=0.1240, mean=0.1240
[Val] Acc: 0.8333 | F1: 0.9000
[[1 0]
 [2 9]]
[Val] Sigmoid Range: min=0.3626, max=0.9444, mean=0.7372

🔁 Epoch 15
[Train] Loss: 0.1868 | Acc: 1.0000 | F1: 1.0000
[[29  0]
 [ 0 36]]
[Train] Sigmoid Range: min=0.0097, max=0.0097, mean=0.0097
[Val] Acc: 0.6667 | F1: 0.7778
[[1 0]
 [4 7]]
[Val] Sigmoid Range: min=0.0483, max=0.8576, mean=0.4929

🔁 Epoch 16
[Train] Loss: 0.3372 | Acc: 0.8308 | F1: 0.8070
[[31  0]
 [11 23]]
[Train] Sigmoid Range: min=0.0085, max=0.0085, mean=0.0085
[Val] Acc: 0.6667 | F1: 0.7778
[[1 0]
 [4 7]]
[Val] Sigmoid Range: min=0.0346, max=0.8639, mean=0.4909

🔁 Epoch 17
[Train] Loss: 0.3813 | Acc: 0.8923 | F1: 0.8772
[[33  0]
 [ 7 25]]
[Train] Sigmoid Range: min=0.5992, max=0.5992, mean=0.5992
[Val] Acc: 0.7500 | F1: 0.8421
[[1 0]
 [3 8]]
[Val] Sigmoid Range: min=0.0723, max=0.9586, mean=0.6312

🔁 Epoch 18
[Train] Loss: 0.1638 | Acc: 1.0000 | F1: 1.0000
[[36  0]
 [ 0 29]]
[Train] Sigmoid Range: min=0.0617, max=0.0617, mean=0.0617
[Val] Acc: 0.9167 | F1: 0.9524
[[ 1  0]
 [ 1 10]]
[Val] Sigmoid Range: min=0.1431, max=0.9824, mean=0.7681

🔁 Epoch 19
[Train] Loss: 0.1175 | Acc: 1.0000 | F1: 1.0000
[[34  0]
 [ 0 31]]
[Train] Sigmoid Range: min=0.9749, max=0.9749, mean=0.9749
[Val] Acc: 0.8333 | F1: 0.9000
[[1 0]
 [2 9]]
[Val] Sigmoid Range: min=0.0794, max=0.9828, mean=0.7129

🔁 Epoch 20
[Train] Loss: 0.1486 | Acc: 1.0000 | F1: 1.0000
[[37  0]
 [ 0 28]]
[Train] Sigmoid Range: min=0.0555, max=0.0555, mean=0.0555
[Val] Acc: 0.7500 | F1: 0.8421
[[1 0]
 [3 8]]
[Val] Sigmoid Range: min=0.0364, max=0.9777, mean=0.6447

🔁 Epoch 21
[Train] Loss: 0.0812 | Acc: 0.9846 | F1: 0.9855
[[30  0]
 [ 1 34]]
[Train] Sigmoid Range: min=0.9744, max=0.9744, mean=0.9744
[Val] Acc: 0.7500 | F1: 0.8421
[[1 0]
 [3 8]]
[Val] Sigmoid Range: min=0.0239, max=0.9750, mean=0.6181

🔁 Epoch 22
[Train] Loss: 0.1242 | Acc: 1.0000 | F1: 1.0000
[[30  0]
 [ 0 35]]
[Train] Sigmoid Range: min=0.9233, max=0.9233, mean=0.9233
[Val] Acc: 0.8333 | F1: 0.9000
[[1 0]
 [2 9]]
[Val] Sigmoid Range: min=0.0337, max=0.9836, mean=0.6574

🔁 Epoch 23
[Train] Loss: 0.0300 | Acc: 1.0000 | F1: 1.0000
[[36  0]
 [ 0 29]]
[Train] Sigmoid Range: min=0.9950, max=0.9950, mean=0.9950
[Val] Acc: 0.8333 | F1: 0.9000
[[1 0]
 [2 9]]
[Val] Sigmoid Range: min=0.0627, max=0.9917, mean=0.7192

🔁 Epoch 24
[Train] Loss: 0.0760 | Acc: 1.0000 | F1: 1.0000
[[35  0]
 [ 0 30]]
[Train] Sigmoid Range: min=0.0224, max=0.0224, mean=0.0224
[Val] Acc: 0.8333 | F1: 0.9000
[[1 0]
 [2 9]]
[Val] Sigmoid Range: min=0.0708, max=0.9937, mean=0.7345

🔁 Epoch 25
[Train] Loss: 0.0546 | Acc: 1.0000 | F1: 1.0000
[[29  0]
 [ 0 36]]
[Train] Sigmoid Range: min=0.0099, max=0.0099, mean=0.0099
[Val] Acc: 0.8333 | F1: 0.9000
[[1 0]
 [2 9]]
[Val] Sigmoid Range: min=0.0555, max=0.9943, mean=0.7172

🔁 Epoch 26
[Train] Loss: 0.0752 | Acc: 1.0000 | F1: 1.0000
[[32  0]
 [ 0 33]]
[Train] Sigmoid Range: min=0.0500, max=0.0500, mean=0.0500
[Val] Acc: 0.8333 | F1: 0.9000
[[1 0]
 [2 9]]
[Val] Sigmoid Range: min=0.0361, max=0.9936, mean=0.6906

🔁 Epoch 27
[Train] Loss: 0.0306 | Acc: 1.0000 | F1: 1.0000
[[37  0]
 [ 0 28]]
[Train] Sigmoid Range: min=0.9868, max=0.9868, mean=0.9868
[Val] Acc: 0.7500 | F1: 0.8421
[[1 0]
 [3 8]]
[Val] Sigmoid Range: min=0.0193, max=0.9896, mean=0.6505

🔁 Epoch 28
[Train] Loss: 0.0204 | Acc: 1.0000 | F1: 1.0000
[[39  0]
 [ 0 26]]
[Train] Sigmoid Range: min=0.0010, max=0.0010, mean=0.0010
[Val] Acc: 0.7500 | F1: 0.8421
[[1 0]
 [3 8]]
[Val] Sigmoid Range: min=0.0141, max=0.9873, mean=0.6356

🔁 Epoch 29
[Train] Loss: 0.0510 | Acc: 1.0000 | F1: 1.0000
[[30  0]
 [ 0 35]]
[Train] Sigmoid Range: min=0.9712, max=0.9712, mean=0.9712
[Val] Acc: 0.7500 | F1: 0.8421
[[1 0]
 [3 8]]
[Val] Sigmoid Range: min=0.0151, max=0.9918, mean=0.6579

🔁 Epoch 30
[Train] Loss: 0.0220 | Acc: 1.0000 | F1: 1.0000
[[42  0]
 [ 0 23]]
[Train] Sigmoid Range: min=0.9919, max=0.9919, mean=0.9919
[Val] Acc: 0.8333 | F1: 0.9000
[[1 0]
 [2 9]]
[Val] Sigmoid Range: min=0.0225, max=0.9956, mean=0.6966

🔁 Epoch 31
[Train] Loss: 0.0638 | Acc: 1.0000 | F1: 1.0000
[[30  0]
 [ 0 35]]
[Train] Sigmoid Range: min=0.0380, max=0.0380, mean=0.0380
[Val] Acc: 0.8333 | F1: 0.9000
[[1 0]
 [2 9]]
[Val] Sigmoid Range: min=0.0324, max=0.9971, mean=0.7275

🔁 Epoch 32
[Train] Loss: 0.0252 | Acc: 1.0000 | F1: 1.0000
[[33  0]
 [ 0 32]]
[Train] Sigmoid Range: min=0.9916, max=0.9916, mean=0.9916
[Val] Acc: 0.8333 | F1: 0.9000
[[1 0]
 [2 9]]
[Val] Sigmoid Range: min=0.0396, max=0.9975, mean=0.7447

🔁 Epoch 33
[Train] Loss: 0.0260 | Acc: 1.0000 | F1: 1.0000
[[32  0]
 [ 0 33]]
[Train] Sigmoid Range: min=0.0009, max=0.0009, mean=0.0009
[Val] Acc: 0.8333 | F1: 0.9000
[[1 0]
 [2 9]]
[Val] Sigmoid Range: min=0.0427, max=0.9976, mean=0.7531

🔁 Epoch 34
[Train] Loss: 0.0180 | Acc: 1.0000 | F1: 1.0000
[[39  0]
 [ 0 26]]
[Train] Sigmoid Range: min=0.0006, max=0.0006, mean=0.0006
[Val] Acc: 0.8333 | F1: 0.9000
[[1 0]
 [2 9]]
[Val] Sigmoid Range: min=0.0421, max=0.9977, mean=0.7541

🔁 Epoch 35
[Train] Loss: 0.0191 | Acc: 1.0000 | F1: 1.0000
[[33  0]
 [ 0 32]]
[Train] Sigmoid Range: min=0.9744, max=0.9744, mean=0.9744
[Val] Acc: 0.8333 | F1: 0.9000
[[1 0]
 [2 9]]
[Val] Sigmoid Range: min=0.0394, max=0.9978, mean=0.7514

🔁 Epoch 36
[Train] Loss: 0.0221 | Acc: 1.0000 | F1: 1.0000
[[38  0]
 [ 0 27]]
[Train] Sigmoid Range: min=0.0002, max=0.0002, mean=0.0002
[Val] Acc: 0.8333 | F1: 0.9000
[[1 0]
 [2 9]]
[Val] Sigmoid Range: min=0.0318, max=0.9978, mean=0.7323

🔁 Epoch 37
[Train] Loss: 0.0108 | Acc: 1.0000 | F1: 1.0000
[[28  0]
 [ 0 37]]
[Train] Sigmoid Range: min=0.0011, max=0.0011, mean=0.0011
[Val] Acc: 0.8333 | F1: 0.9000
[[1 0]
 [2 9]]
[Val] Sigmoid Range: min=0.0279, max=0.9978, mean=0.7222

🔁 Epoch 38
[Train] Loss: 0.0121 | Acc: 1.0000 | F1: 1.0000
[[33  0]
 [ 0 32]]
[Train] Sigmoid Range: min=0.0031, max=0.0031, mean=0.0031
[Val] Acc: 0.8333 | F1: 0.9000
[[1 0]
 [2 9]]
[Val] Sigmoid Range: min=0.0255, max=0.9978, mean=0.7174

🔁 Epoch 39
[Train] Loss: 0.0136 | Acc: 1.0000 | F1: 1.0000
[[34  0]
 [ 0 31]]
[Train] Sigmoid Range: min=0.9989, max=0.9989, mean=0.9989
[Val] Acc: 0.8333 | F1: 0.9000
[[1 0]
 [2 9]]
[Val] Sigmoid Range: min=0.0252, max=0.9980, mean=0.7204
✅ Saved model: 0704_fracture_classifier_agegroup0.pt

🔹 Training for Age Group 1...

🔁 Epoch 0
[Train] Loss: 18.3864 | Acc: 0.5959 | F1: 0.3605
[[402  16]
 [321  95]]
[Train] Sigmoid Range: min=0.0786, max=0.9744, mean=0.5265
[Val] Acc: 0.4861 | F1: 0.4249
[[ 64   2]
 [109  41]]
[Val] Sigmoid Range: min=0.0381, max=0.9674, mean=0.2885

🔁 Epoch 1
[Train] Loss: 9.1296 | Acc: 0.8273 | F1: 0.8011
[[400   3]
 [141 290]]
[Train] Sigmoid Range: min=0.0031, max=0.9026, mean=0.4528
[Val] Acc: 0.9213 | F1: 0.9420
[[ 61   5]
 [ 12 138]]
[Val] Sigmoid Range: min=0.0007, max=0.9992, mean=0.6436

🔁 Epoch 2
[Train] Loss: 4.8787 | Acc: 0.9436 | F1: 0.9406
[[415   8]
 [ 39 372]]
[Train] Sigmoid Range: min=0.1504, max=0.9415, mean=0.5460
[Val] Acc: 0.9306 | F1: 0.9511
[[ 55  11]
 [  4 146]]
[Val] Sigmoid Range: min=0.0017, max=0.9997, mean=0.7345

🔁 Epoch 3
[Train] Loss: 2.2293 | Acc: 0.9784 | F1: 0.9769
[[436   2]
 [ 16 380]]
[Train] Sigmoid Range: min=0.0105, max=0.9994, mean=0.5049
[Val] Acc: 0.9398 | F1: 0.9568
[[ 59   7]
 [  6 144]]
[Val] Sigmoid Range: min=0.0008, max=0.9999, mean=0.7013

🔁 Epoch 4
[Train] Loss: 1.7132 | Acc: 0.9796 | F1: 0.9793
[[414   3]
 [ 14 403]]
[Train] Sigmoid Range: min=0.0024, max=0.0085, mean=0.0054
[Val] Acc: 0.9491 | F1: 0.9635
[[ 60   6]
 [  5 145]]
[Val] Sigmoid Range: min=0.0004, max=1.0000, mean=0.7000

🔁 Epoch 5
[Train] Loss: 1.0241 | Acc: 0.9880 | F1: 0.9877
[[421   1]
 [  9 403]]
[Train] Sigmoid Range: min=0.9985, max=0.9998, mean=0.9991
[Val] Acc: 0.9537 | F1: 0.9667
[[ 61   5]
 [  5 145]]
[Val] Sigmoid Range: min=0.0001, max=1.0000, mean=0.6931

🔁 Epoch 6
[Train] Loss: 0.7134 | Acc: 0.9928 | F1: 0.9925
[[430   1]
 [  5 398]]
[Train] Sigmoid Range: min=0.0002, max=0.0191, mean=0.0096
[Val] Acc: 0.9352 | F1: 0.9542
[[ 56  10]
 [  4 146]]
[Val] Sigmoid Range: min=0.0001, max=1.0000, mean=0.7177

🔁 Epoch 7
[Train] Loss: 1.6019 | Acc: 0.9868 | F1: 0.9868
[[411   1]
 [ 10 412]]
[Train] Sigmoid Range: min=0.9998, max=1.0000, mean=0.9999
[Val] Acc: 0.9352 | F1: 0.9542
[[ 56  10]
 [  4 146]]
[Val] Sigmoid Range: min=0.0013, max=1.0000, mean=0.7327

🔁 Epoch 8
[Train] Loss: 0.6111 | Acc: 0.9964 | F1: 0.9963
[[430   0]
 [  3 401]]
[Train] Sigmoid Range: min=0.0014, max=0.9999, mean=0.5006
[Val] Acc: 0.9491 | F1: 0.9637
[[ 59   7]
 [  4 146]]
[Val] Sigmoid Range: min=0.0001, max=1.0000, mean=0.7026

🔁 Epoch 9
[Train] Loss: 0.1858 | Acc: 0.9988 | F1: 0.9988
[[412   0]
 [  1 421]]
[Train] Sigmoid Range: min=0.0000, max=0.9996, mean=0.4998
[Val] Acc: 0.9444 | F1: 0.9600
[[ 60   6]
 [  6 144]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6881

🔁 Epoch 10
[Train] Loss: 0.1144 | Acc: 1.0000 | F1: 1.0000
[[410   0]
 [  0 424]]
[Train] Sigmoid Range: min=0.0002, max=1.0000, mean=0.5001
[Val] Acc: 0.9444 | F1: 0.9603
[[ 59   7]
 [  5 145]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7003

🔁 Epoch 11
[Train] Loss: 0.0571 | Acc: 1.0000 | F1: 1.0000
[[423   0]
 [  0 411]]
[Train] Sigmoid Range: min=0.0001, max=0.0001, mean=0.0001
[Val] Acc: 0.9491 | F1: 0.9637
[[ 59   7]
 [  4 146]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7086

🔁 Epoch 12
[Train] Loss: 0.0447 | Acc: 1.0000 | F1: 1.0000
[[413   0]
 [  0 421]]
[Train] Sigmoid Range: min=0.9815, max=0.9985, mean=0.9900
[Val] Acc: 0.9444 | F1: 0.9603
[[ 59   7]
 [  5 145]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7038

🔁 Epoch 13
[Train] Loss: 0.0609 | Acc: 0.9988 | F1: 0.9988
[[426   0]
 [  1 407]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5000
[Val] Acc: 0.9491 | F1: 0.9637
[[ 59   7]
 [  4 146]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7089

🔁 Epoch 14
[Train] Loss: 0.0405 | Acc: 1.0000 | F1: 1.0000
[[405   0]
 [  0 429]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5000
[Val] Acc: 0.9352 | F1: 0.9542
[[ 56  10]
 [  4 146]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7238

🔁 Epoch 15
[Train] Loss: 0.0608 | Acc: 1.0000 | F1: 1.0000
[[418   0]
 [  0 416]]
[Train] Sigmoid Range: min=0.9998, max=1.0000, mean=0.9999
[Val] Acc: 0.9444 | F1: 0.9603
[[ 59   7]
 [  5 145]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7045

🔁 Epoch 16
[Train] Loss: 0.0512 | Acc: 1.0000 | F1: 1.0000
[[392   0]
 [  0 442]]
[Train] Sigmoid Range: min=0.9999, max=1.0000, mean=1.0000
[Val] Acc: 0.9444 | F1: 0.9603
[[ 59   7]
 [  5 145]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7042

🔁 Epoch 17
[Train] Loss: 0.2381 | Acc: 0.9988 | F1: 0.9988
[[423   0]
 [  1 410]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5000
[Val] Acc: 0.9352 | F1: 0.9542
[[ 56  10]
 [  4 146]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7259

🔁 Epoch 18
[Train] Loss: 0.0312 | Acc: 1.0000 | F1: 1.0000
[[411   0]
 [  0 423]]
[Train] Sigmoid Range: min=1.0000, max=1.0000, mean=1.0000
[Val] Acc: 0.9491 | F1: 0.9632
[[ 61   5]
 [  6 144]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6900

🔁 Epoch 19
[Train] Loss: 0.0346 | Acc: 1.0000 | F1: 1.0000
[[419   0]
 [  0 415]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5000
[Val] Acc: 0.9537 | F1: 0.9667
[[ 61   5]
 [  5 145]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6977

🔁 Epoch 20
[Train] Loss: 0.0206 | Acc: 1.0000 | F1: 1.0000
[[397   0]
 [  0 437]]
[Train] Sigmoid Range: min=0.0005, max=1.0000, mean=0.5002
[Val] Acc: 0.9537 | F1: 0.9667
[[ 61   5]
 [  5 145]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6963

🔁 Epoch 21
[Train] Loss: 0.0352 | Acc: 1.0000 | F1: 1.0000
[[410   0]
 [  0 424]]
[Train] Sigmoid Range: min=1.0000, max=1.0000, mean=1.0000
[Val] Acc: 0.9491 | F1: 0.9632
[[ 61   5]
 [  6 144]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6844

🔁 Epoch 22
[Train] Loss: 1.3744 | Acc: 0.9868 | F1: 0.9867
[[415   3]
 [  8 408]]
[Train] Sigmoid Range: min=0.9983, max=0.9998, mean=0.9990
[Val] Acc: 0.8981 | F1: 0.9304
[[ 47  19]
 [  3 147]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7694

🔁 Epoch 23
[Train] Loss: 1.0241 | Acc: 0.9892 | F1: 0.9889
[[424   2]
 [  7 401]]
[Train] Sigmoid Range: min=0.0010, max=0.9999, mean=0.5004
[Val] Acc: 0.9444 | F1: 0.9600
[[ 60   6]
 [  6 144]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6908

🔁 Epoch 24
[Train] Loss: 0.2685 | Acc: 0.9964 | F1: 0.9965
[[405   1]
 [  2 426]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5000
[Val] Acc: 0.9398 | F1: 0.9565
[[ 60   6]
 [  7 143]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6887

🔁 Epoch 25
[Train] Loss: 0.0735 | Acc: 1.0000 | F1: 1.0000
[[410   0]
 [  0 424]]
[Train] Sigmoid Range: min=0.9921, max=0.9999, mean=0.9960
[Val] Acc: 0.9398 | F1: 0.9568
[[ 59   7]
 [  6 144]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7016

🔁 Epoch 26
[Train] Loss: 0.0381 | Acc: 1.0000 | F1: 1.0000
[[407   0]
 [  0 427]]
[Train] Sigmoid Range: min=0.0000, max=0.0001, mean=0.0001
[Val] Acc: 0.9491 | F1: 0.9632
[[ 61   5]
 [  6 144]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6975

🔁 Epoch 27
[Train] Loss: 0.2266 | Acc: 0.9964 | F1: 0.9964
[[418   1]
 [  2 413]]
[Train] Sigmoid Range: min=0.0000, max=0.9990, mean=0.4995
[Val] Acc: 0.9352 | F1: 0.9542
[[ 56  10]
 [  4 146]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7186

🔁 Epoch 28
[Train] Loss: 0.0277 | Acc: 1.0000 | F1: 1.0000
[[418   0]
 [  0 416]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5000
[Val] Acc: 0.9444 | F1: 0.9605
[[ 58   8]
 [  4 146]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7052

🔁 Epoch 29
[Train] Loss: 0.1504 | Acc: 0.9976 | F1: 0.9976
[[412   1]
 [  1 420]]
[Train] Sigmoid Range: min=0.0000, max=0.0002, mean=0.0001
[Val] Acc: 0.9120 | F1: 0.9338
[[ 63   3]
 [ 16 134]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6366

🔁 Epoch 30
[Train] Loss: 0.3874 | Acc: 0.9928 | F1: 0.9927
[[422   0]
 [  6 406]]
[Train] Sigmoid Range: min=0.0003, max=1.0000, mean=0.5001
[Val] Acc: 0.9398 | F1: 0.9562
[[ 61   5]
 [  8 142]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6805

🔁 Epoch 31
[Train] Loss: 0.0314 | Acc: 1.0000 | F1: 1.0000
[[421   0]
 [  0 413]]
[Train] Sigmoid Range: min=0.0000, max=0.0001, mean=0.0000
[Val] Acc: 0.9352 | F1: 0.9524
[[ 62   4]
 [ 10 140]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6671

🔁 Epoch 32
[Train] Loss: 0.0660 | Acc: 1.0000 | F1: 1.0000
[[398   0]
 [  0 436]]
[Train] Sigmoid Range: min=1.0000, max=1.0000, mean=1.0000
[Val] Acc: 0.9444 | F1: 0.9597
[[ 61   5]
 [  7 143]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6823

🔁 Epoch 33
[Train] Loss: 0.0199 | Acc: 1.0000 | F1: 1.0000
[[396   0]
 [  0 438]]
[Train] Sigmoid Range: min=0.0000, max=0.9997, mean=0.4999
[Val] Acc: 0.9491 | F1: 0.9632
[[ 61   5]
 [  6 144]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6867

🔁 Epoch 34
[Train] Loss: 0.0153 | Acc: 1.0000 | F1: 1.0000
[[406   0]
 [  0 428]]
[Train] Sigmoid Range: min=0.0000, max=0.0003, mean=0.0002
[Val] Acc: 0.9398 | F1: 0.9568
[[ 59   7]
 [  6 144]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6982

🔁 Epoch 35
[Train] Loss: 0.0087 | Acc: 1.0000 | F1: 1.0000
[[420   0]
 [  0 414]]
[Train] Sigmoid Range: min=1.0000, max=1.0000, mean=1.0000
[Val] Acc: 0.9444 | F1: 0.9600
[[ 60   6]
 [  6 144]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6932

🔁 Epoch 36
[Train] Loss: 0.0133 | Acc: 1.0000 | F1: 1.0000
[[416   0]
 [  0 418]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5000
[Val] Acc: 0.9491 | F1: 0.9637
[[ 59   7]
 [  4 146]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7064

🔁 Epoch 37
[Train] Loss: 0.5147 | Acc: 0.9916 | F1: 0.9911
[[439   2]
 [  5 388]]
[Train] Sigmoid Range: min=0.0000, max=0.0000, mean=0.0000
[Val] Acc: 0.9352 | F1: 0.9521
[[ 63   3]
 [ 11 139]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6587

🔁 Epoch 38
[Train] Loss: 0.1958 | Acc: 0.9988 | F1: 0.9988
[[421   1]
 [  0 412]]
[Train] Sigmoid Range: min=0.9999, max=1.0000, mean=1.0000
[Val] Acc: 0.9259 | F1: 0.9463
[[ 59   7]
 [  9 141]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6904

🔁 Epoch 39
[Train] Loss: 0.0549 | Acc: 1.0000 | F1: 1.0000
[[413   0]
 [  0 421]]
[Train] Sigmoid Range: min=0.9734, max=1.0000, mean=0.9867
[Val] Acc: 0.9444 | F1: 0.9605
[[ 58   8]
 [  4 146]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7126
✅ Saved model: 0704_fracture_classifier_agegroup1.pt

🔹 Training for Age Group 2...

🔁 Epoch 0
[Train] Loss: 41.2724 | Acc: 0.8215 | F1: 0.7876
[[2359   54]
 [ 804 1591]]
[Train] Sigmoid Range: min=0.0023, max=0.9989, mean=0.4727
[Val] Acc: 0.9279 | F1: 0.9537
[[214  21]
 [ 62 854]]
[Val] Sigmoid Range: min=0.0008, max=0.9993, mean=0.7466

🔁 Epoch 1
[Train] Loss: 12.3220 | Acc: 0.9638 | F1: 0.9625
[[2398   15]
 [ 159 2236]]
[Train] Sigmoid Range: min=0.0012, max=0.9998, mean=0.4812
[Val] Acc: 0.9383 | F1: 0.9603
[[221  14]
 [ 57 859]]
[Val] Sigmoid Range: min=0.0001, max=0.9999, mean=0.7514

🔁 Epoch 2
[Train] Loss: 10.9582 | Acc: 0.9673 | F1: 0.9671
[[2344   14]
 [ 143 2307]]
[Train] Sigmoid Range: min=0.0016, max=0.9985, mean=0.5835
[Val] Acc: 0.8810 | F1: 0.9198
[[228   7]
 [130 786]]
[Val] Sigmoid Range: min=0.0003, max=0.9999, mean=0.6845

🔁 Epoch 3
[Train] Loss: 7.0581 | Acc: 0.9794 | F1: 0.9786
[[2441    3]
 [  96 2268]]
[Train] Sigmoid Range: min=0.0013, max=0.9999, mean=0.5051
[Val] Acc: 0.9470 | F1: 0.9663
[[216  19]
 [ 42 874]]
[Val] Sigmoid Range: min=0.0004, max=1.0000, mean=0.7725

🔁 Epoch 4
[Train] Loss: 4.5063 | Acc: 0.9869 | F1: 0.9866
[[2420    2]
 [  61 2325]]
[Train] Sigmoid Range: min=0.0006, max=1.0000, mean=0.6236
[Val] Acc: 0.9435 | F1: 0.9640
[[215  20]
 [ 45 871]]
[Val] Sigmoid Range: min=0.0001, max=1.0000, mean=0.7748

🔁 Epoch 5
[Train] Loss: 5.0967 | Acc: 0.9846 | F1: 0.9842
[[2423    5]
 [  69 2311]]
[Train] Sigmoid Range: min=0.0002, max=1.0000, mean=0.6255
[Val] Acc: 0.9409 | F1: 0.9620
[[222  13]
 [ 55 861]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7572

🔁 Epoch 6
[Train] Loss: 4.0155 | Acc: 0.9902 | F1: 0.9900
[[2445    2]
 [  45 2316]]
[Train] Sigmoid Range: min=0.0002, max=1.0000, mean=0.3756
[Val] Acc: 0.9444 | F1: 0.9644
[[221  14]
 [ 50 866]]
[Val] Sigmoid Range: min=0.0001, max=1.0000, mean=0.7662

🔁 Epoch 7
[Train] Loss: 2.9635 | Acc: 0.9906 | F1: 0.9904
[[2442    3]
 [  42 2321]]
[Train] Sigmoid Range: min=0.0003, max=1.0000, mean=0.5003
[Val] Acc: 0.9540 | F1: 0.9708
[[216  19]
 [ 34 882]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7817

🔁 Epoch 8
[Train] Loss: 1.9451 | Acc: 0.9940 | F1: 0.9939
[[2407    1]
 [  28 2372]]
[Train] Sigmoid Range: min=0.0002, max=1.0000, mean=0.5005
[Val] Acc: 0.9566 | F1: 0.9726
[[214  21]
 [ 29 887]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7887

🔁 Epoch 9
[Train] Loss: 2.2863 | Acc: 0.9923 | F1: 0.9923
[[2382    2]
 [  35 2389]]
[Train] Sigmoid Range: min=0.0001, max=1.0000, mean=0.3750
[Val] Acc: 0.9479 | F1: 0.9668
[[218  17]
 [ 43 873]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7731

🔁 Epoch 10
[Train] Loss: 3.3882 | Acc: 0.9898 | F1: 0.9898
[[2376    5]
 [  44 2383]]
[Train] Sigmoid Range: min=0.0002, max=1.0000, mean=0.5002
[Val] Acc: 0.9548 | F1: 0.9714
[[216  19]
 [ 33 883]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7817

🔁 Epoch 11
[Train] Loss: 2.1399 | Acc: 0.9933 | F1: 0.9936
[[2302    2]
 [  30 2474]]
[Train] Sigmoid Range: min=0.0001, max=1.0000, mean=0.5003
[Val] Acc: 0.9574 | F1: 0.9733
[[209  26]
 [ 23 893]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.8005

🔁 Epoch 12
[Train] Loss: 1.2818 | Acc: 0.9954 | F1: 0.9953
[[2442    2]
 [  20 2344]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.1252
[Val] Acc: 0.9566 | F1: 0.9726
[[215  20]
 [ 30 886]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7860

🔁 Epoch 13
[Train] Loss: 0.4413 | Acc: 0.9990 | F1: 0.9989
[[2503    0]
 [   5 2300]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5000
[Val] Acc: 0.9574 | F1: 0.9733
[[210  25]
 [ 24 892]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7970

🔁 Epoch 14
[Train] Loss: 1.5970 | Acc: 0.9950 | F1: 0.9951
[[2360    1]
 [  23 2424]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3751
[Val] Acc: 0.9574 | F1: 0.9731
[[215  20]
 [ 29 887]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7884

🔁 Epoch 15
[Train] Loss: 0.7181 | Acc: 0.9979 | F1: 0.9979
[[2393    0]
 [  10 2405]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3751
[Val] Acc: 0.9496 | F1: 0.9679
[[218  17]
 [ 41 875]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7764

🔁 Epoch 16
[Train] Loss: 0.6654 | Acc: 0.9983 | F1: 0.9984
[[2365    1]
 [   7 2435]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3750
[Val] Acc: 0.9513 | F1: 0.9691
[[216  19]
 [ 37 879]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7800

🔁 Epoch 17
[Train] Loss: 2.5284 | Acc: 0.9927 | F1: 0.9927
[[2391    3]
 [  32 2382]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6253
[Val] Acc: 0.9531 | F1: 0.9703
[[216  19]
 [ 35 881]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7810

🔁 Epoch 18
[Train] Loss: 0.6335 | Acc: 0.9975 | F1: 0.9976
[[2353    0]
 [  12 2443]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3756
[Val] Acc: 0.9540 | F1: 0.9710
[[211  24]
 [ 29 887]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7910

🔁 Epoch 19
[Train] Loss: 0.3903 | Acc: 0.9992 | F1: 0.9992
[[2389    0]
 [   4 2415]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6250
[Val] Acc: 0.9531 | F1: 0.9704
[[212  23]
 [ 31 885]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7898

🔁 Epoch 20
[Train] Loss: 1.0634 | Acc: 0.9963 | F1: 0.9963
[[2366    1]
 [  17 2424]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7500
[Val] Acc: 0.9548 | F1: 0.9715
[[212  23]
 [ 29 887]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7921

🔁 Epoch 21
[Train] Loss: 0.6266 | Acc: 0.9981 | F1: 0.9981
[[2401    0]
 [   9 2398]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5000
[Val] Acc: 0.9557 | F1: 0.9721
[[211  24]
 [ 27 889]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7919

🔁 Epoch 22
[Train] Loss: 0.8071 | Acc: 0.9979 | F1: 0.9980
[[2314    1]
 [   9 2484]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5002
[Val] Acc: 0.9531 | F1: 0.9703
[[215  20]
 [ 34 882]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7844

🔁 Epoch 23
[Train] Loss: 1.6966 | Acc: 0.9944 | F1: 0.9944
[[2382    2]
 [  25 2399]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3078
[Val] Acc: 0.9513 | F1: 0.9691
[[217  18]
 [ 38 878]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7777

🔁 Epoch 24
[Train] Loss: 1.2837 | Acc: 0.9960 | F1: 0.9960
[[2401    2]
 [  17 2388]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3750
[Val] Acc: 0.9548 | F1: 0.9714
[[217  18]
 [ 34 882]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7823

🔁 Epoch 25
[Train] Loss: 0.5675 | Acc: 0.9981 | F1: 0.9981
[[2426    0]
 [   9 2373]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3750
[Val] Acc: 0.9531 | F1: 0.9703
[[215  20]
 [ 34 882]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7847

🔁 Epoch 26
[Train] Loss: 0.5141 | Acc: 0.9985 | F1: 0.9986
[[2359    0]
 [   7 2442]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6250
[Val] Acc: 0.9496 | F1: 0.9684
[[203  32]
 [ 26 890]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.8013

🔁 Epoch 27
[Train] Loss: 0.3926 | Acc: 0.9988 | F1: 0.9987
[[2412    0]
 [   6 2390]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5000
[Val] Acc: 0.9522 | F1: 0.9697
[[216  19]
 [ 36 880]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7828

🔁 Epoch 28
[Train] Loss: 0.3928 | Acc: 0.9985 | F1: 0.9985
[[2438    0]
 [   7 2363]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5001
[Val] Acc: 0.9531 | F1: 0.9704
[[212  23]
 [ 31 885]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7885

🔁 Epoch 29
[Train] Loss: 1.9944 | Acc: 0.9944 | F1: 0.9943
[[2431    5]
 [  22 2350]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.2686
[Val] Acc: 0.9513 | F1: 0.9692
[[215  20]
 [ 36 880]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7822

🔁 Epoch 30
[Train] Loss: 0.8919 | Acc: 0.9973 | F1: 0.9972
[[2443    2]
 [  11 2352]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.2501
[Val] Acc: 0.9566 | F1: 0.9727
[[211  24]
 [ 26 890]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7949

🔁 Epoch 31
[Train] Loss: 0.1625 | Acc: 0.9996 | F1: 0.9996
[[2377    0]
 [   2 2429]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6250
[Val] Acc: 0.9557 | F1: 0.9721
[[211  24]
 [ 27 889]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7934

🔁 Epoch 32
[Train] Loss: 0.9029 | Acc: 0.9977 | F1: 0.9977
[[2404    1]
 [  10 2393]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3750
[Val] Acc: 0.9513 | F1: 0.9691
[[217  18]
 [ 38 878]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7778

🔁 Epoch 33
[Train] Loss: 1.3184 | Acc: 0.9956 | F1: 0.9956
[[2391    3]
 [  18 2396]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.1256
[Val] Acc: 0.9505 | F1: 0.9685
[[219  16]
 [ 41 875]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7711

🔁 Epoch 34
[Train] Loss: 0.1490 | Acc: 0.9996 | F1: 0.9996
[[2394    0]
 [   2 2412]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3751
[Val] Acc: 0.9548 | F1: 0.9714
[[217  18]
 [ 34 882]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7824

🔁 Epoch 35
[Train] Loss: 0.2640 | Acc: 0.9994 | F1: 0.9994
[[2432    0]
 [   3 2373]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5001
[Val] Acc: 0.9540 | F1: 0.9709
[[214  21]
 [ 32 884]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7860

🔁 Epoch 36
[Train] Loss: 0.6612 | Acc: 0.9981 | F1: 0.9981
[[2383    1]
 [   8 2416]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5000
[Val] Acc: 0.9574 | F1: 0.9733
[[210  25]
 [ 24 892]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7965

🔁 Epoch 37
[Train] Loss: 0.0265 | Acc: 1.0000 | F1: 1.0000
[[2409    0]
 [   0 2399]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6250
[Val] Acc: 0.9531 | F1: 0.9703
[[214  21]
 [ 33 883]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7869

🔁 Epoch 38
[Train] Loss: 0.6760 | Acc: 0.9985 | F1: 0.9985
[[2404    1]
 [   6 2397]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5002
[Val] Acc: 0.9540 | F1: 0.9711
[[206  29]
 [ 24 892]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.8015

🔁 Epoch 39
[Train] Loss: 0.5336 | Acc: 0.9983 | F1: 0.9983
[[2389    1]
 [   7 2411]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6250
[Val] Acc: 0.9600 | F1: 0.9748
[[214  21]
 [ 25 891]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7943
✅ Saved model: 0704_fracture_classifier_agegroup2.pt

🔹 Training for Age Group 3...

🔁 Epoch 0
[Train] Loss: 133.8343 | Acc: 0.8321 | F1: 0.8091
[[3610  252]
 [1020 2695]]
[Train] Sigmoid Range: min=0.0442, max=0.9998, mean=0.4693
[Val] Acc: 0.8812 | F1: 0.8992
[[ 678   28]
 [ 201 1021]]
[Val] Sigmoid Range: min=0.0133, max=0.9999, mean=0.5542

🔁 Epoch 1
[Train] Loss: 67.0584 | Acc: 0.9261 | F1: 0.9243
[[3598  125]
 [ 435 3419]]
[Train] Sigmoid Range: min=0.0162, max=0.9999, mean=0.4593
[Val] Acc: 0.9118 | F1: 0.9272
[[ 676   30]
 [ 140 1082]]
[Val] Sigmoid Range: min=0.0028, max=1.0000, mean=0.5825

🔁 Epoch 2
[Train] Loss: 46.0629 | Acc: 0.9521 | F1: 0.9501
[[3756   77]
 [ 286 3458]]
[Train] Sigmoid Range: min=0.0034, max=0.9999, mean=0.5970
[Val] Acc: 0.9155 | F1: 0.9317
[[ 653   53]
 [ 110 1112]]
[Val] Sigmoid Range: min=0.0007, max=1.0000, mean=0.6074

🔁 Epoch 3
[Train] Loss: 33.0313 | Acc: 0.9686 | F1: 0.9679
[[3755   41]
 [ 197 3584]]
[Train] Sigmoid Range: min=0.0053, max=1.0000, mean=0.6541
[Val] Acc: 0.9134 | F1: 0.9285
[[ 677   29]
 [ 138 1084]]
[Val] Sigmoid Range: min=0.0002, max=1.0000, mean=0.5823

🔁 Epoch 4
[Train] Loss: 26.2275 | Acc: 0.9745 | F1: 0.9743
[[3729   35]
 [ 158 3655]]
[Train] Sigmoid Range: min=0.0004, max=1.0000, mean=0.3486
[Val] Acc: 0.9248 | F1: 0.9397
[[ 654   52]
 [  93 1129]]
[Val] Sigmoid Range: min=0.0001, max=1.0000, mean=0.6187

🔁 Epoch 5
[Train] Loss: 20.1789 | Acc: 0.9810 | F1: 0.9807
[[3782   21]
 [ 123 3651]]
[Train] Sigmoid Range: min=0.0003, max=1.0000, mean=0.6281
[Val] Acc: 0.9118 | F1: 0.9270
[[ 678   28]
 [ 142 1080]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5782

🔁 Epoch 6
[Train] Loss: 14.6890 | Acc: 0.9856 | F1: 0.9858
[[3694   21]
 [  88 3774]]
[Train] Sigmoid Range: min=0.0007, max=1.0000, mean=0.4470
[Val] Acc: 0.9186 | F1: 0.9336
[[ 668   38]
 [ 119 1103]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5920

🔁 Epoch 7
[Train] Loss: 14.3408 | Acc: 0.9861 | F1: 0.9860
[[3769   22]
 [  83 3703]]
[Train] Sigmoid Range: min=0.0011, max=1.0000, mean=0.5570
[Val] Acc: 0.9118 | F1: 0.9300
[[ 629   77]
 [  93 1129]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6272

🔁 Epoch 8
[Train] Loss: 9.0950 | Acc: 0.9910 | F1: 0.9911
[[3736   11]
 [  57 3773]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3336
[Val] Acc: 0.9123 | F1: 0.9274
[[ 679   27]
 [ 142 1080]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5739

🔁 Epoch 9
[Train] Loss: 12.8672 | Acc: 0.9884 | F1: 0.9880
[[3869   19]
 [  69 3620]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.4340
[Val] Acc: 0.9123 | F1: 0.9282
[[ 667   39]
 [ 130 1092]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5880

🔁 Epoch 10
[Train] Loss: 5.8958 | Acc: 0.9942 | F1: 0.9942
[[3760   10]
 [  34 3773]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.4449
[Val] Acc: 0.9212 | F1: 0.9356
[[ 672   34]
 [ 118 1104]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5961

🔁 Epoch 11
[Train] Loss: 4.5521 | Acc: 0.9958 | F1: 0.9958
[[3769    6]
 [  26 3776]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3333
[Val] Acc: 0.9217 | F1: 0.9373
[[ 648   58]
 [  93 1129]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6194

🔁 Epoch 12
[Train] Loss: 4.8540 | Acc: 0.9963 | F1: 0.9963
[[3777    7]
 [  21 3772]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.4443
[Val] Acc: 0.8869 | F1: 0.9036
[[ 688   18]
 [ 200 1022]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5411

🔁 Epoch 13
[Train] Loss: 6.8475 | Acc: 0.9933 | F1: 0.9932
[[3780   14]
 [  37 3746]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6667
[Val] Acc: 0.9201 | F1: 0.9360
[[ 648   58]
 [  96 1126]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6129

🔁 Epoch 14
[Train] Loss: 4.0136 | Acc: 0.9959 | F1: 0.9959
[[3759    8]
 [  23 3787]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.2602
[Val] Acc: 0.9191 | F1: 0.9338
[[ 672   34]
 [ 122 1100]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5882

🔁 Epoch 15
[Train] Loss: 5.1301 | Acc: 0.9958 | F1: 0.9957
[[3876    9]
 [  23 3669]]
[Train] Sigmoid Range: min=0.0002, max=1.0000, mean=0.3491
[Val] Acc: 0.9191 | F1: 0.9355
[[ 641   65]
 [  91 1131]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6219

🔁 Epoch 16
[Train] Loss: 4.9436 | Acc: 0.9956 | F1: 0.9956
[[3801    8]
 [  25 3743]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3335
[Val] Acc: 0.9196 | F1: 0.9343
[[ 671   35]
 [ 120 1102]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5889

🔁 Epoch 17
[Train] Loss: 4.5533 | Acc: 0.9955 | F1: 0.9955
[[3793   10]
 [  24 3750]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.4450
[Val] Acc: 0.9269 | F1: 0.9409
[[ 665   41]
 [ 100 1122]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6042

🔁 Epoch 18
[Train] Loss: 4.0417 | Acc: 0.9964 | F1: 0.9963
[[3903    6]
 [  21 3647]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.2266
[Val] Acc: 0.9118 | F1: 0.9300
[[ 628   78]
 [  92 1130]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6299

🔁 Epoch 19
[Train] Loss: 5.6298 | Acc: 0.9941 | F1: 0.9941
[[3753   15]
 [  30 3779]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6657
[Val] Acc: 0.9165 | F1: 0.9312
[[ 678   28]
 [ 133 1089]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5773

🔁 Epoch 20
[Train] Loss: 2.9632 | Acc: 0.9974 | F1: 0.9973
[[3807    6]
 [  14 3750]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5555
[Val] Acc: 0.9222 | F1: 0.9374
[[ 655   51]
 [  99 1123]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6080

🔁 Epoch 21
[Train] Loss: 4.1608 | Acc: 0.9958 | F1: 0.9957
[[3800   12]
 [  20 3745]]
[Train] Sigmoid Range: min=0.0001, max=1.0000, mean=0.3352
[Val] Acc: 0.9165 | F1: 0.9334
[[ 639   67]
 [  94 1128]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6210

🔁 Epoch 22
[Train] Loss: 3.2133 | Acc: 0.9975 | F1: 0.9975
[[3811    6]
 [  13 3747]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3339
[Val] Acc: 0.9155 | F1: 0.9307
[[ 670   36]
 [ 127 1095]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5892

🔁 Epoch 23
[Train] Loss: 2.7609 | Acc: 0.9975 | F1: 0.9974
[[3861    6]
 [  13 3697]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6668
[Val] Acc: 0.9180 | F1: 0.9338
[[ 655   51]
 [ 107 1115]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6063

🔁 Epoch 24
[Train] Loss: 2.8035 | Acc: 0.9975 | F1: 0.9975
[[3777    5]
 [  14 3781]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5554
[Val] Acc: 0.9227 | F1: 0.9376
[[ 660   46]
 [ 103 1119]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6044

🔁 Epoch 25
[Train] Loss: 5.0761 | Acc: 0.9952 | F1: 0.9953
[[3765   16]
 [  20 3776]]
[Train] Sigmoid Range: min=0.0004, max=0.9999, mean=0.2253
[Val] Acc: 0.9103 | F1: 0.9256
[[ 679   27]
 [ 146 1076]]
[Val] Sigmoid Range: min=0.0001, max=1.0000, mean=0.5698

🔁 Epoch 26
[Train] Loss: 1.7781 | Acc: 0.9984 | F1: 0.9984
[[3737    2]
 [  10 3828]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6666
[Val] Acc: 0.9222 | F1: 0.9367
[[ 668   38]
 [ 112 1110]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5942

🔁 Epoch 27
[Train] Loss: 2.4303 | Acc: 0.9976 | F1: 0.9976
[[3805    5]
 [  13 3754]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.4445
[Val] Acc: 0.9248 | F1: 0.9392
[[ 663   43]
 [ 102 1120]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6036

🔁 Epoch 28
[Train] Loss: 1.3458 | Acc: 0.9992 | F1: 0.9992
[[3796    2]
 [   4 3775]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7776
[Val] Acc: 0.9263 | F1: 0.9405
[[ 664   42]
 [ 100 1122]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6027

🔁 Epoch 29
[Train] Loss: 2.9292 | Acc: 0.9974 | F1: 0.9973
[[3802    7]
 [  13 3755]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.4487
[Val] Acc: 0.9191 | F1: 0.9334
[[ 679   27]
 [ 129 1093]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5805

🔁 Epoch 30
[Train] Loss: 3.3073 | Acc: 0.9971 | F1: 0.9971
[[3815    7]
 [  15 3740]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.4447
[Val] Acc: 0.9222 | F1: 0.9371
[[ 660   46]
 [ 104 1118]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6036

🔁 Epoch 31
[Train] Loss: 1.4320 | Acc: 0.9985 | F1: 0.9986
[[3732    3]
 [   8 3834]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7776
[Val] Acc: 0.9222 | F1: 0.9368
[[ 666   40]
 [ 110 1112]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6001

🔁 Epoch 32
[Train] Loss: 2.2562 | Acc: 0.9985 | F1: 0.9985
[[3807    4]
 [   7 3759]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3334
[Val] Acc: 0.9253 | F1: 0.9394
[[ 667   39]
 [ 105 1117]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5986

🔁 Epoch 33
[Train] Loss: 2.1206 | Acc: 0.9979 | F1: 0.9979
[[3730    5]
 [  11 3831]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5556
[Val] Acc: 0.9175 | F1: 0.9341
[[ 642   64]
 [  95 1127]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6195

🔁 Epoch 34
[Train] Loss: 1.5130 | Acc: 0.9982 | F1: 0.9981
[[3806    4]
 [  10 3757]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3211
[Val] Acc: 0.9196 | F1: 0.9347
[[ 664   42]
 [ 113 1109]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5986

🔁 Epoch 35
[Train] Loss: 5.5200 | Acc: 0.9951 | F1: 0.9951
[[3798   13]
 [  24 3742]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5556
[Val] Acc: 0.9222 | F1: 0.9375
[[ 653   53]
 [  97 1125]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6120

🔁 Epoch 36
[Train] Loss: 1.3623 | Acc: 0.9989 | F1: 0.9989
[[3783    2]
 [   6 3786]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.4444
[Val] Acc: 0.9144 | F1: 0.9299
[[ 668   38]
 [ 127 1095]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5865

🔁 Epoch 37
[Train] Loss: 1.9484 | Acc: 0.9985 | F1: 0.9985
[[3853    4]
 [   7 3713]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6667
[Val] Acc: 0.9134 | F1: 0.9287
[[ 674   32]
 [ 135 1087]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5819

🔁 Epoch 38
[Train] Loss: 3.0678 | Acc: 0.9968 | F1: 0.9968
[[3762    8]
 [  16 3791]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.4444
[Val] Acc: 0.8926 | F1: 0.9093
[[ 684   22]
 [ 185 1037]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5478

🔁 Epoch 39
[Train] Loss: 2.1655 | Acc: 0.9978 | F1: 0.9978
[[3757    5]
 [  12 3803]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6666
[Val] Acc: 0.9217 | F1: 0.9365
[[ 664   42]
 [ 109 1113]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.6004
✅ Saved model: 0704_fracture_classifier_agegroup3.pt

🔹 Training for Age Group 4...

🔁 Epoch 0
[Train] Loss: 76.7769 | Acc: 0.7106 | F1: 0.7335
[[611 365]
 [201 779]]
[Train] Sigmoid Range: min=0.3604, max=0.9326, mean=0.6342
[Val] Acc: 0.7734 | F1: 0.7554
[[213  91]
 [ 23 176]]
[Val] Sigmoid Range: min=0.0574, max=0.9951, mean=0.5722

🔁 Epoch 1
[Train] Loss: 54.7450 | Acc: 0.8430 | F1: 0.8446
[[815 170]
 [137 834]]
[Train] Sigmoid Range: min=0.0668, max=0.9709, mean=0.3018
[Val] Acc: 0.8330 | F1: 0.8047
[[246  58]
 [ 26 173]]
[Val] Sigmoid Range: min=0.0127, max=0.9968, mean=0.4983

🔁 Epoch 2
[Train] Loss: 38.8825 | Acc: 0.8911 | F1: 0.8919
[[864 121]
 [ 92 879]]
[Train] Sigmoid Range: min=0.0483, max=0.9938, mean=0.6512
[Val] Acc: 0.8549 | F1: 0.8274
[[255  49]
 [ 24 175]]
[Val] Sigmoid Range: min=0.0012, max=0.9991, mean=0.4648

🔁 Epoch 3
[Train] Loss: 27.2602 | Acc: 0.9284 | F1: 0.9308
[[874  86]
 [ 54 942]]
[Train] Sigmoid Range: min=0.2781, max=0.9990, mean=0.8150
[Val] Acc: 0.8767 | F1: 0.8473
[[269  35]
 [ 27 172]]
[Val] Sigmoid Range: min=0.0003, max=0.9998, mean=0.4359

🔁 Epoch 4
[Train] Loss: 15.5896 | Acc: 0.9611 | F1: 0.9613
[[937  51]
 [ 25 943]]
[Train] Sigmoid Range: min=0.0003, max=0.9995, mean=0.7455
[Val] Acc: 0.8907 | F1: 0.8533
[[288  16]
 [ 39 160]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3533

🔁 Epoch 5
[Train] Loss: 13.3214 | Acc: 0.9647 | F1: 0.9650
[[937  42]
 [ 27 950]]
[Train] Sigmoid Range: min=0.9953, max=0.9999, mean=0.9982
[Val] Acc: 0.8986 | F1: 0.8661
[[287  17]
 [ 34 165]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3648

🔁 Epoch 6
[Train] Loss: 8.1569 | Acc: 0.9821 | F1: 0.9817
[[980  24]
 [ 11 941]]
[Train] Sigmoid Range: min=0.0181, max=0.9999, mean=0.7418
[Val] Acc: 0.8867 | F1: 0.8564
[[276  28]
 [ 29 170]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3926

🔁 Epoch 7
[Train] Loss: 7.9874 | Acc: 0.9826 | F1: 0.9826
[[961  18]
 [ 16 961]]
[Train] Sigmoid Range: min=0.0004, max=1.0000, mean=0.7499
[Val] Acc: 0.8946 | F1: 0.8672
[[277  27]
 [ 26 173]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.4002

🔁 Epoch 8
[Train] Loss: 6.7886 | Acc: 0.9826 | F1: 0.9824
[[972  20]
 [ 14 950]]
[Train] Sigmoid Range: min=0.0053, max=0.9999, mean=0.5069
[Val] Acc: 0.8926 | F1: 0.8601
[[283  21]
 [ 33 166]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3703

🔁 Epoch 9
[Train] Loss: 4.3388 | Acc: 0.9923 | F1: 0.9923
[[970   9]
 [  6 971]]
[Train] Sigmoid Range: min=0.0000, max=0.9988, mean=0.5559
[Val] Acc: 0.8728 | F1: 0.8351
[[277  27]
 [ 37 162]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3825

🔁 Epoch 10
[Train] Loss: 7.6535 | Acc: 0.9806 | F1: 0.9808
[[949  26]
 [ 12 969]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5001
[Val] Acc: 0.9006 | F1: 0.8705
[[285  19]
 [ 31 168]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3743

🔁 Epoch 11
[Train] Loss: 1.8834 | Acc: 0.9974 | F1: 0.9974
[[991   3]
 [  2 960]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7499
[Val] Acc: 0.8986 | F1: 0.8682
[[284  20]
 [ 31 168]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3693

🔁 Epoch 12
[Train] Loss: 1.1291 | Acc: 0.9985 | F1: 0.9985
[[954   2]
 [  1 999]]
[Train] Sigmoid Range: min=0.0001, max=1.0000, mean=0.7338
[Val] Acc: 0.8907 | F1: 0.8485
[[294  10]
 [ 45 154]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3354

🔁 Epoch 13
[Train] Loss: 0.7411 | Acc: 0.9985 | F1: 0.9984
[[994   2]
 [  1 959]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.2501
[Val] Acc: 0.8907 | F1: 0.8533
[[288  16]
 [ 39 160]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3496

🔁 Epoch 14
[Train] Loss: 0.3837 | Acc: 1.0000 | F1: 1.0000
[[997   0]
 [  0 959]]
[Train] Sigmoid Range: min=0.0007, max=1.0000, mean=0.2542
[Val] Acc: 0.8946 | F1: 0.8623
[[284  20]
 [ 33 166]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3661

🔁 Epoch 15
[Train] Loss: 0.9074 | Acc: 0.9985 | F1: 0.9984
[[1024    1]
 [   2  929]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7281
[Val] Acc: 0.8907 | F1: 0.8525
[[289  15]
 [ 40 159]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3500

🔁 Epoch 16
[Train] Loss: 0.4152 | Acc: 0.9995 | F1: 0.9995
[[992   1]
 [  0 963]]
[Train] Sigmoid Range: min=0.0000, max=0.9974, mean=0.2497
[Val] Acc: 0.8907 | F1: 0.8525
[[289  15]
 [ 40 159]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3431

🔁 Epoch 17
[Train] Loss: 1.6812 | Acc: 0.9944 | F1: 0.9943
[[984   7]
 [  4 961]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.2500
[Val] Acc: 0.9006 | F1: 0.8656
[[292  12]
 [ 38 161]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3414

🔁 Epoch 18
[Train] Loss: 2.3666 | Acc: 0.9949 | F1: 0.9949
[[966   5]
 [  5 980]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5000
[Val] Acc: 0.8926 | F1: 0.8500
[[296   8]
 [ 46 153]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3197

🔁 Epoch 19
[Train] Loss: 1.2962 | Acc: 0.9964 | F1: 0.9964
[[990   5]
 [  2 959]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.2502
[Val] Acc: 0.8946 | F1: 0.8602
[[287  17]
 [ 36 163]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3546

🔁 Epoch 20
[Train] Loss: 6.8268 | Acc: 0.9842 | F1: 0.9850
[[ 910   18]
 [  13 1015]]
[Train] Sigmoid Range: min=0.9854, max=1.0000, mean=0.9955
[Val] Acc: 0.8966 | F1: 0.8579
[[294  10]
 [ 42 157]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3319

🔁 Epoch 21
[Train] Loss: 2.1835 | Acc: 0.9954 | F1: 0.9954
[[983   3]
 [  6 964]]
[Train] Sigmoid Range: min=0.0004, max=1.0000, mean=0.5101
[Val] Acc: 0.8946 | F1: 0.8616
[[285  19]
 [ 34 165]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3672

🔁 Epoch 22
[Train] Loss: 0.7753 | Acc: 0.9980 | F1: 0.9980
[[958   3]
 [  1 994]]
[Train] Sigmoid Range: min=0.0000, max=0.9999, mean=0.2502
[Val] Acc: 0.8946 | F1: 0.8579
[[290  14]
 [ 39 160]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3448

🔁 Epoch 23
[Train] Loss: 1.1791 | Acc: 0.9980 | F1: 0.9980
[[955   2]
 [  2 997]]
[Train] Sigmoid Range: min=1.0000, max=1.0000, mean=1.0000
[Val] Acc: 0.8469 | F1: 0.8222
[[248  56]
 [ 21 178]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.4665

🔁 Epoch 24
[Train] Loss: 0.8520 | Acc: 0.9980 | F1: 0.9979
[[986   3]
 [  1 966]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.2501
[Val] Acc: 0.8847 | F1: 0.8371
[[296   8]
 [ 50 149]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3091

🔁 Epoch 25
[Train] Loss: 0.2302 | Acc: 0.9995 | F1: 0.9995
[[1003    1]
 [   0  952]]
[Train] Sigmoid Range: min=0.0000, max=0.0015, mean=0.0004
[Val] Acc: 0.8907 | F1: 0.8525
[[289  15]
 [ 40 159]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3461

🔁 Epoch 26
[Train] Loss: 0.1642 | Acc: 1.0000 | F1: 1.0000
[[ 954    0]
 [   0 1002]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7500
[Val] Acc: 0.8907 | F1: 0.8501
[[292  12]
 [ 43 156]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3344

🔁 Epoch 27
[Train] Loss: 0.1179 | Acc: 1.0000 | F1: 1.0000
[[974   0]
 [  0 982]]
[Train] Sigmoid Range: min=0.9999, max=1.0000, mean=1.0000
[Val] Acc: 0.8887 | F1: 0.8495
[[289  15]
 [ 41 158]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3421

🔁 Epoch 28
[Train] Loss: 0.2742 | Acc: 0.9995 | F1: 0.9995
[[996   1]
 [  0 959]]
[Train] Sigmoid Range: min=0.0001, max=1.0000, mean=0.5002
[Val] Acc: 0.8907 | F1: 0.8608
[[278  26]
 [ 29 170]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3891

🔁 Epoch 29
[Train] Loss: 0.7344 | Acc: 0.9980 | F1: 0.9979
[[1003    1]
 [   3  949]]
[Train] Sigmoid Range: min=0.0000, max=0.0001, mean=0.0000
[Val] Acc: 0.8867 | F1: 0.8430
[[293  11]
 [ 46 153]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3238

🔁 Epoch 30
[Train] Loss: 0.3224 | Acc: 1.0000 | F1: 1.0000
[[1019    0]
 [   0  937]]
[Train] Sigmoid Range: min=0.0023, max=1.0000, mean=0.7485
[Val] Acc: 0.8847 | F1: 0.8457
[[286  18]
 [ 40 159]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3518

🔁 Epoch 31
[Train] Loss: 2.2753 | Acc: 0.9949 | F1: 0.9948
[[981   4]
 [  6 965]]
[Train] Sigmoid Range: min=0.0000, max=0.0000, mean=0.0000
[Val] Acc: 0.8907 | F1: 0.8518
[[290  14]
 [ 41 158]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3381

🔁 Epoch 32
[Train] Loss: 0.8848 | Acc: 0.9990 | F1: 0.9990
[[ 941    1]
 [   1 1013]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.2502
[Val] Acc: 0.8787 | F1: 0.8432
[[278  26]
 [ 35 164]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3804

🔁 Epoch 33
[Train] Loss: 3.3790 | Acc: 0.9908 | F1: 0.9911
[[ 932   11]
 [   7 1006]]
[Train] Sigmoid Range: min=0.0001, max=1.0000, mean=0.2528
[Val] Acc: 0.8847 | F1: 0.8528
[[277  27]
 [ 31 168]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3835

🔁 Epoch 34
[Train] Loss: 0.4594 | Acc: 0.9990 | F1: 0.9990
[[973   1]
 [  1 981]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.7498
[Val] Acc: 0.8926 | F1: 0.8586
[[285  19]
 [ 35 164]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3639

🔁 Epoch 35
[Train] Loss: 3.0866 | Acc: 0.9959 | F1: 0.9960
[[963   4]
 [  4 985]]
[Train] Sigmoid Range: min=0.9987, max=0.9998, mean=0.9993
[Val] Acc: 0.8907 | F1: 0.8468
[[296   8]
 [ 47 152]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3197

🔁 Epoch 36
[Train] Loss: 0.6113 | Acc: 0.9990 | F1: 0.9990
[[977   1]
 [  1 977]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.2500
[Val] Acc: 0.8986 | F1: 0.8640
[[290  14]
 [ 37 162]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3502

🔁 Epoch 37
[Train] Loss: 0.0923 | Acc: 1.0000 | F1: 1.0000
[[ 943    0]
 [   0 1013]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5000
[Val] Acc: 0.8986 | F1: 0.8647
[[289  15]
 [ 36 163]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3524

🔁 Epoch 38
[Train] Loss: 0.0739 | Acc: 1.0000 | F1: 1.0000
[[983   0]
 [  0 973]]
[Train] Sigmoid Range: min=0.0000, max=1.0000, mean=0.5000
[Val] Acc: 0.8966 | F1: 0.8587
[[293  11]
 [ 41 158]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.3411

🔁 Epoch 39
[Train] Loss: 1.0163 | Acc: 0.9980 | F1: 0.9979
[[986   3]
 [  1 966]]
[Train] Sigmoid Range: min=0.8174, max=1.0000, mean=0.9449
[Val] Acc: 0.8827 | F1: 0.8309
[[299   5]
 [ 54 145]]
[Val] Sigmoid Range: min=0.0000, max=1.0000, mean=0.2980
✅ Saved model: 0704_fracture_classifier_agegroup4.pt

📌 Step 4: Test Trained Model ...

🔍 Grad-CAM for Age Group 0...
/home/kimgk3793/anaconda3/envs/swin/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
100%|██████████| 40/40 [00:04<00:00,  8.78it/s]

📊 Confusion Matrix for Age Group 0:
[[15  5]
 [ 2 18]]

🔍 Grad-CAM for Age Group 1...
100%|██████████| 60/60 [00:06<00:00,  9.88it/s]

📊 Confusion Matrix for Age Group 1:
[[29  1]
 [ 2 28]]

🔍 Grad-CAM for Age Group 2...
100%|██████████| 80/80 [00:08<00:00,  9.04it/s]

📊 Confusion Matrix for Age Group 2:
[[32  8]
 [ 2 38]]

🔍 Grad-CAM for Age Group 3...
100%|██████████| 140/140 [00:16<00:00,  8.55it/s]

📊 Confusion Matrix for Age Group 3:
[[51 19]
 [11 59]]

🔍 Grad-CAM for Age Group 4...
100%|██████████| 60/60 [00:07<00:00,  8.25it/s]

📊 Confusion Matrix for Age Group 4:
[[30  0]
 [ 1 29]]

🎉 All steps completed successfully!

종료 코드 0(으)로 완료된 프로세스

